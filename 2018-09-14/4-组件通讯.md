# 组件通讯

组件之间的 **数据传递**、**事件传递** 即为 **组件通讯**

## 父子组件

### $refs

```js
this.$refs["ref_name"]
this.$refs["ref_name"].$options.name
this.$refs["ref_name"].data_attribute
this.$refs["ref_name"].function_name
```

### $children

```js
this.$children[0]
this.$children[0].$options
this.$children[0].data_attribute
this.$refs[0].function_name
```

### $parent

```js
this.$parent
this.$parent.$data
this.$parent.data_attribute
this.$parent.function_name
```

### prop

- camelCase vs kebab-case

```html
<!-- HTML 特性名称不区分大小写 -->
<!-- 最终 data-blogId 会转换成 data-blogid -->
<div data-blogId="1"></div>
<div data-blogid="1"></div>
```

```js
// 因此当你在子组件中声明一个 cameClass 的 prop 时
Vue.component('blog-post', {
    // 在 JS 中 prop 是 cameClass 的
    props: ['blogId'],
    template: '<div>{{ blogTitle }}</div>'
})
```

```html
<!-- 在 HTML 中是 kebab-case 的 -->
<blog-post blog-id="1"></blog-post>
```

- 传递静态、动态的 prop

```html
<!-- 静态的传递 -->
<blog-post blog-id="1"></blog-post>
<!-- 动态的传递 -->
<blog-post v-bind:blog-id="PARENT_COMPONENT_DATA_ATTRIBUTE"></blog-post>
```

### $attrs

```html
<!-- In Parent Component -->
<child-component data-abc="parent-attr-data"></child-component>
```

```js
// In Child Component
Vue.component('child-component', {
    // 不使用 prop 接收 data-abc
    mounted: function() {
        console.log(this.$attrs);
        // 输出 {data-abc: "parent-attr-data"}
    }
})
// 类似: 获取 DOM 对象后,获取特性名称对应的值
// $node.attr('data-abc');
```

### 双向绑定

- 父组件传递 prop 时, 添加 .sync 修饰符
```html
<!-- 详见 ChildTree.vue -->
<child-component :blog-id.sync="blog.id"></child-component>
```
- 子组件接收 prop 后, 将其复制为自身的 data
```js
Vue.component("child-component", {
    props:["blogId"],
    data: function() {
        // 1.
        id: this.blogId
    },
    watch: {
        // 2.
        blogId(val){
            this.id = val
        },
        // 3.
        id(val){
            this.$emit("update:blogId", val)
        }
    }
})
```
- 子组件 watch 


## 兄弟 & 祖孙组件通讯

- eventBus
- vuex

## 实战

- EOS 采购计划单详情